<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flybondi ¬∑ Anunciador Multiling√ºe</title>

  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#FFD200" />

  <link rel="icon" href="assets/logo.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="assets/logo.svg">

  <link rel="stylesheet" href="styles.css" />

  <script>
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      const btn = document.getElementById('installBtn');
      if (btn) btn.style.display = 'inline-flex';
    });
    async function installPWA() {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
      const btn = document.getElementById('installBtn');
      if (btn) btn.style.display = 'none';
    }
  </script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="assets/logo.svg" alt="Flybondi" />
      <span>Anunciador Multiling√ºe</span>
    </div>
    <div class="actions">
      <button id="installBtn" class="btn primary" style="display:none" onclick="installPWA()">Instalar app</button>
      <button id="voicesRefresh" class="btn ghost" title="Recargar voces">üîÅ Voces</button>
    </div>
  </header>

  <main>
    <section class="card">
      <h2>Datos del vuelo</h2>
      <div class="grid two">
        <label class="field">
          <span>N√∫mero de vuelo</span>
          <input id="flightNumber" placeholder="FO512" />
        </label>

        <label class="field">
          <span>Destino</span>
          <select id="destination"></select>
        </label>
      </div>

      <div class="grid two">
        <label class="field">
          <span>Puerta de embarque</span>
          <input id="gateNumber" placeholder="5 / 5A" />
        </label>

        <label class="field">
          <span>Puerta secundaria (si cambia)</span>
          <input id="gateNumber2" placeholder="6 / 6B" />
        </label>
      </div>

      <div class="grid two">
        <label class="field">
          <span>Grupos de embarque</span>
          <div class="actions" style="margin:6px 0 10px 0;"><button class="btn ghost" id="selectAllGroups">Seleccionar todos</button><button class="btn ghost" id="clearGroups">Limpiar</button></div>
<div id="boardingGroups" class="checks grid-groups">
  <label class="chk"><input type="checkbox" value="1"> Grupo 1 <small>(filas 1‚Äì8)</small></label>
  <label class="chk"><input type="checkbox" value="2"> Grupo 2 <small>(filas 9‚Äì16)</small></label>
  <label class="chk"><input type="checkbox" value="3"> Grupo 3 <small>(filas 17‚Äì24)</small></label>
  <label class="chk"><input type="checkbox" value="4"> Grupo 4 <small>(filas 25‚Äì32)</small></label>
  <label class="chk all"><input type="checkbox" value="ALL"> Todos</label>
</div>
        </label>

        <label class="field">
          <span>Modo de idioma</span>
          <select id="langMode">
            <option value="ES">Espa√±ol</option>
            <option value="ES_EN">Espa√±ol + Ingl√©s</option>
            <option value="ES_PT">Espa√±ol + Portugu√©s</option>
            <option value="ES_EN_PT">Espa√±ol + Ingl√©s + Portugu√©s</option>
          </select>
        </label>
      </div>
    </section>

    <section class="card">
      <h2>Plantillas</h2>
      <div class="grid two">
        <label class="field">
          <span>Tipo de anuncio</span>
          <select id="templateType">
            <option value="preboarding">Pre-embarque</option>
            <option value="start">Inicio de embarque</option>
            <option value="groups">Llamada por grupos</option>
            <option value="lastcall">√öltimo aviso de embarque</option>
            <option value="delay">Anuncio por demora</option>
            <option value="cancel">Anuncio por cancelaci√≥n</option>
            <option value="conditional">Vuelo condicional</option>
            <option value="custom">Texto libre</option>
          </select>
        </label>

        <label class="field" id="customTextWrap" style="display:none">
          <span>Texto libre (ES)</span>
          <textarea id="customText" placeholder="Escrib√≠ aqu√≠ tu anuncio en espa√±ol..."></textarea>
        </label>
      </div>

      <div class="grid two">
        <label class="field" id="delayReasonWrap" style="display:none">
          <span>Motivo de demora (opcional)</span>
          <input id="delayReason" placeholder="Retraso por rotaci√≥n de aeronave"/>
        </label>
      </div>

      <div class="grid two">
        <label class="field">
          <span>Saludo</span>
          <select id="greeting">
            <option value="none">Sin saludo</option>
            <option value="morning">Buenos d√≠as</option>
            <option value="afternoon">Buenas tardes</option>
            <option value="evening">Buenas noches</option>
          </select>
        </label>

        <label class="field" id="altDestWrap" style="display:none">
          <span>Aeropuerto alternativo (vuelo condicional)</span>
          <select id="altDestination"></select>
        </label>
      </div>

      <div class="grid three voice-row">
        <label class="field">
          <span>Voz ESP</span>
          <select id="voiceES"></select>
        </label>
        <label class="field">
          <span>Voz ENG</span>
          <select id="voiceEN"></select>
        </label>
        <label class="field">
          <span>Voz POR</span>
          <select id="voicePT"></select>
        </label>
      </div>

      <div class="grid three">
        <label class="field">
          <span>Tono</span>
          <input id="pitch" type="range" min="0.5" max="2" value="1" step="0.1" />
        </label>
        <label class="field">
          <span>Velocidad</span>
          <input id="rate" type="range" min="0.7" max="1.3" value="1" step="0.05" />
        </label>
        <label class="field">
          <span>Volumen</span>
          <input id="volume" type="range" min="0" max="1" value="1" step="0.05" />
        </label>
      </div>

      <div class="toggles">
        <label class="chk"><input type="checkbox" id="malePref"> Preferir voz masculina</label>
        <label class="chk"><input type="checkbox" id="femalePref"> Preferir voz femenina</label>
        <label class="chk"><input type="checkbox" id="queueMode" checked> Reproducir en secuencia</label>
      </div>

      <div class="actions">
        <button class="btn primary" id="previewBtn">üîä Reproducir anuncio</button>
        <button class="btn" id="stopBtn">‚èπÔ∏è Detener</button>
        <button class="btn ghost" id="copyBtn" title="Copia el texto generado">üìã Copiar texto</button>
      </div>

      <div class="output" id="outputArea">
        <h3>Texto generado</h3>
        <div id="outES"></div>
        <div id="outEN"></div>
        <div id="outPT"></div>
      </div>
    </section>

    <section class="card small">
      <details>
        <summary>Opciones avanzadas</summary>
        <div class="grid two">
          <label class="field">
            <span>Prefijo de audio (campana)</span>
            <select id="chime">
              <option value="none">Ninguno</option>
              <option value="ding">Ding</option>
              <option value="dingdong">Ding-dong</option>
            </select>
          </label>
          <label class="field">
            <span>Pausa entre idiomas (ms)</span>
            <input id="pauseMs" type="number" value="400" min="0" step="50"/>
          </label>
        </div>
        <p class="muted">Sugerencia: prob√° diferentes voces del sistema para lograr una voz m√°s natural. En iOS/Safari suele haber voces de alta calidad.</p>
      </details>
    </section>
  </main>

  <footer class="footer">
    <span>Hecho para operaciones Flybondi ¬∑ PWA instalable</span>
  </footer>

  <script src="app.js"></script>
</body>
</html>
